import{A as g,j as r,n as h,r as i}from"./index-DexmHjjZ.js";import{B as k}from"./Button-rV_nHCNG.js";import{a as u}from"./app.hooks-BIjLwyUw.js";import"./className-CUjXWMz9.js";const j="_products_pyern_1",N={products:j},P=g.injectEndpoints({endpoints:e=>({getStaffProducts:e.query({query:()=>"staff/products",providesTags:["Staff"]}),markProductReady:e.mutation({query:o=>({url:"staff/ready",method:"PATCH",body:o}),invalidatesTags:["Staff"]})})}),{useLazyGetStaffProductsQuery:S,useMarkProductReadyMutation:b}=P,_="_product_1xkos_1",T="_content_1xkos_18",m={product:_,content:T},q=e=>{const{orderProductId:o,quantity:n,status:c,productName:s,preferences:a,tableNumber:t,orderTime:f}=e,[p,{isLoading:l}]=b(),y=new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),x=()=>{p({orderProductId:o,tableNumber:t})};return r.jsxs("div",{className:m.product,children:[r.jsxs("div",{className:m.content,children:[r.jsxs("h2",{children:[s," x",n]}),r.jsxs("p",{children:["Comandat la ",y]})]}),r.jsx(k,{text:"Ready",color:"green",tall:!0,onClick:x,loading:l})]})},R=void 0,d=h(R,{withCredentials:!0,transports:["websocket"]}),v=(e,o,n)=>{if(["cook","barman","barista"].includes(o)){const c=`${o}-${e}`;d.emit("join-location",c),d.off("order-ping"),d.on("order-ping",s=>{n()})}},C=({})=>{const[e,{data:o,isLoading:n,error:c}]=S(),{id:s}=u(t=>t.location),{user:a}=u(t=>t.auth);return i.useEffect(()=>{e()},[e]),i.useEffect(()=>{!s||!a||v(s,a.role,()=>{e()})},[s,a,e]),r.jsx("div",{className:N.products,children:o&&o.length>0?o.map(t=>r.jsx(q,{orderProductId:t.orderProductId,quantity:t.quantity,status:t.status,productName:t.productName,preferences:t.preferences,tableNumber:t.tableNumber,orderTime:t.orderTime},t.orderProductId)):"Nu exista produse momentan!"})},w=C;export{w as component};
