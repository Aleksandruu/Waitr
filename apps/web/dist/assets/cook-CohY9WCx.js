import{A as h,j as s,n as g,r as i}from"./index-EQ7WCn_a.js";import{B as k}from"./Button-NgNVC6NY.js";import{a as u}from"./app.hooks-DxXljtc5.js";import"./className-CUjXWMz9.js";const j="_products_pyern_1",N={products:j},P=h.injectEndpoints({endpoints:e=>({getStaffProducts:e.query({query:()=>"staff/products",providesTags:["Staff"]}),markProductReady:e.mutation({query:o=>({url:"staff/ready",method:"PATCH",body:o}),invalidatesTags:["Staff"]})})}),{useLazyGetStaffProductsQuery:S,useMarkProductReadyMutation:b}=P,_="_product_1xkos_1",T="_content_1xkos_18",m={product:_,content:T},q=e=>{const{orderProductId:o,quantity:a,status:c,productName:r,preferences:n,tableNumber:t,orderTime:f}=e,[p,{isLoading:l}]=b(),y=new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),x=()=>{p({orderProductId:o,tableNumber:t})};return s.jsxs("div",{className:m.product,children:[s.jsxs("div",{className:m.content,children:[s.jsxs("h2",{children:[r," x",a]}),s.jsxs("p",{children:["Comandat la ",y]})]}),s.jsx(k,{text:"Ready",color:"green",tall:!0,onClick:x,loading:l})]})},R="http://localhost:8080",d=g(R,{withCredentials:!0,transports:["websocket"]}),v=(e,o,a)=>{if(["cook","barman","barista"].includes(o)){const c=`${o}-${e}`;d.emit("join-location",c),d.off("order-ping"),d.on("order-ping",r=>{a()})}},C=({})=>{const[e,{data:o,isLoading:a,error:c}]=S(),{id:r}=u(t=>t.location),{user:n}=u(t=>t.auth);return i.useEffect(()=>{e()},[e]),i.useEffect(()=>{!r||!n||v(r,n.role,()=>{e()})},[r,n,e]),s.jsx("div",{className:N.products,children:o&&o.length>0?o.map(t=>s.jsx(q,{orderProductId:t.orderProductId,quantity:t.quantity,status:t.status,productName:t.productName,preferences:t.preferences,tableNumber:t.tableNumber,orderTime:t.orderTime},t.orderProductId)):"Nu exista produse momentan!"})},w=C;export{w as component};
