import{q as h,j as s,l as x,h as i,r as u}from"./index-CCuYgNzZ.js";import{B as g}from"./Button-C4_vQ40n.js";import"./className-CUjXWMz9.js";const k="_products_pyern_1",j={products:k},S=h.injectEndpoints({endpoints:e=>({getStaffProducts:e.query({query:()=>"staff/products",providesTags:["Staff"]}),markProductReady:e.mutation({query:o=>({url:"staff/ready",method:"PATCH",body:o}),invalidatesTags:["Staff"]})})}),{useLazyGetStaffProductsQuery:P,useMarkProductReadyMutation:_}=S,N="_product_1xkos_1",b="_content_1xkos_18",f={product:N,content:b},T=({orderProductId:e,quantity:o,status:c,productName:n,preferences:r,tableNumber:a,orderTime:t})=>{const[l,{isLoading:m}]=_(),p=new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),y=()=>{l({orderProductId:e,tableNumber:a})};return s.jsxs("div",{className:f.product,children:[s.jsxs("div",{className:f.content,children:[s.jsxs("h2",{children:[n," x",o]}),s.jsxs("p",{children:["Comandat la ",p]})]}),s.jsx(g,{text:"Ready",color:"green",tall:!0,onClick:y,loading:m})]})},q="http://localhost:8080",d=x(q,{withCredentials:!0,transports:["websocket"]}),R=(e,o,c)=>{if(["cook","barman","barista"].includes(o)){const n=`${o}-${e}`;d.emit("join-location",n),d.off("order-ping"),d.on("order-ping",r=>{c()})}},v=({})=>{const[e,{data:o,isLoading:c,error:n}]=P(),{id:r}=i(t=>t.location),{user:a}=i(t=>t.auth);return u.useEffect(()=>{e()},[e]),u.useEffect(()=>{!r||!a||R(r,a.role,()=>{e()})},[r,a,e]),s.jsx("div",{className:j.products,children:o&&o.map(t=>s.jsx(T,{orderProductId:t.orderProductId,quantity:t.quantity,status:t.status,productName:t.productName,preferences:t.preferences,tableNumber:t.tableNumber,orderTime:t.orderTime},t.orderProductId))})},I=v;export{I as component};
